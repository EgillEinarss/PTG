
%% dot -Tpng exampleLR0M.gz -o exampleLR0M.png
%% 
%%  
%%

\documentclass[11pt,a4paper]{article}

\usepackage[american]{babel}
\usepackage[pdftex]{hyperref}
\usepackage{times}
\usepackage[T1]{fontenc}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{arrows,automata}
\usetikzlibrary{shapes.multipart}
\usetikzlibrary{shapes.misc}

\begin{document}

\renewcommand{\contentsname}%
	{Table of Contents}
\renewcommand{\abstractname}%
	{abstract}
\sloppy
\title{PTG(beta) User Manual}
\author{Egill Búi Einarsson}
\maketitle

\begin{abstract}
PTG is a command-line program that generates files containing parsing tables and state machines for a given grammar. Generated tables are in either \LaTeX{} or HTML format which eases automated inserting of generated elements. Likewise the state machines can be inserted directly when TIKZ format is used. Alternativily state machines can use Graphviz's digraph automaton format for use with Graphviz DOT.
\end{abstract}

\section{Copyleft}
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.


This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.


You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.

\tableofcontents

\section{Introduction}

PTG is run from a command-line terminal and generates parsing tables and state machines for LL(1), LR(0) and LR(1) grammars. A grammar's FIRST, FOLLOW, LL(1), SLR(1) and LALR(1) parsing tables can be generated in either \LaTeX{} or HTML format along with LR(0) and LR(1) state machines in Graphviz's digraph automaton format for use with DOT. The idea is when creating a document for a particular grammar that features some or all of these tables, instead of copying into the master file the generated files are dynamically linked. The result is that the document can be updated [...]

No guarantee is made that this software will run smoothly, without flaws, without destroying other files, without corrupting data, without crashing your system, at all... etc. Please show the appropiate caution when running any software from the internet. Furthermore no guarantee is made on the correctness of the output. The second to last section of this manual details what to do if an error is encountered.

\section{Setup}

Setup is simple as long as a JRE(Java Runtime Environment) has been setup. Go to the \href{https://github.com/EgillEinarss/PTG}{PTG repository} on Github.com and download PTG.jar. Place this file in the current command line directory and run

\begin{lstlisting}[frame=single]
java -jar PTG ...
\end{lstlisting}

\noindent along with any relevant arguments(detailed in the next section).

\subsection{Compiling the Source}

Required programs are \href{http://git-scm.com/}{git} and \href{http://www.gnu.org/software/make/}{make}.
Use a command line. If needed, go to your projects directory and get the project with the command

\begin{lstlisting}[frame=single]
git clone https://github.com/EgillEinarss/PTG.git
cd PTG
\end{lstlisting}

\noindent Alternatively go to the \href{https://github.com/EgillEinarss/PTG}{PTG repository} on Github.com and download what you want or require.
Now you have the developement environment setup used to create PTG. Now simply run the compilation process with the command

\begin{lstlisting}[frame=single]
make
\end{lstlisting}

\noindent Simple.
Feel free to modify the source code in the directory src, also any Java source files added into src will be compiled and added to the PTG jar file created by running make.


\section{Missing Features}

Some features are still waiting to be implemented or are improperly implented. This manual might even describe these features as if they were implemented. A partial list of features or components in limbo:

\begin{itemize}
\item LALR(1) machines are incorrect(besides not existing), resulting in incorrect LALR(1) tables.
\item The LR option does nothing.
\item Tikz is displaying terrible machines.
\item This manual is far from resembling a useful manual.
\item Tables for machines with memory, print an entry for each item in memory.
\item No table outputed for tiny state machines.
\item -ALL is missing items.
\item The help text is outdated.
\end{itemize}

\section{Command Line Arguments}

The syntax for command line execution is

\begin{lstlisting}[frame=single]
java -jar PTG Grammar Options Output
\end{lstlisting}

\noindent where


\begin{description}
	\item[Grammar] The file containing the grammar to be parsed. Required and must be the first argument.
	\item[Options] A few options that define the grammar. Any number of them may be used and must be followed by a String, see Settings for String.
	\begin{description}
		\item[-START] Sets the grammar's start variable to String. Default is the first variable listed in Grammar.
		\item[-END] Sets the grammar's end of input token to String. Default is "\$".
		\item[-EMPTY] Sets the grammar's empty string token as String. Default is "<e>".
	\end{description}
	\item[Output] This is the output request. All of them can be followed by Settings, if a String is defined then it will be the output file name, default is the filename of the grammar.
	\begin{description}
		\item[-ALL] Performs all of the following outputs.
		\item[-FIRST] Creates a First table.
		\item[-FOLLOW] Creates a Follow table.
		\item[-LL1] Creates a LL(1) table.
		\item[-SLR1] Creates a SLR(1) table.
		\item[-LR1] Creates a LR(1) table.
		\item[-LALR1] Creates a LALR(1) table.
		\item[-LR0M] Creates a LR(0) state machine.
		\item[-LR1M] Creates a LR(1) state machine.
		\item[-LALRM] Creates a LALR(0) state machine.
	\end{description}
	\item[Settings] Any and all settings are optional, some are not applicable but cause no error.
	\begin{description}
		\item[HTML] The table being defined will only have HTML output.
		\item[LATEX] The table being defined will only have \LaTeX output.
		\item[GZ] The state machine being defined will be in GraphViz's DOT format.
		\item[TIKZ] The state machine being defined will be in Tikz format.
		\item[TINY] The state machine being defined will contain only a label, will produce a table for more information.
		\item[SMALL] The state machine being defined will have a decreased description if possible.
		\item[LARGE] The state machine being defined will have a full description.
		\item[LR] The state machine being defined will go from left to right rather than top to bottom.
		\item[String] Any string of characters that is not one of the above defined keywords, pretty much anything is accepted but might cause catastrophic failure.
	\end{description}
\end{description}

Note that the keywords are in capital letters for clarity but in face PTG is case insensitive in regards to keywords. Here are a few example calls:

\begin{lstlisting}[frame=single]
java -jar PTG example.gra -all
java -jar PTG example.gra -start Var2 -end EoF -empty e -ll1 html
\end{lstlisting}


\indent \verb#java -jar PTG Grammar [-Start symbol] [-End symbol] [-Empty symbol] #

\indent ~ ~ \verb#( [-table [table_type] [out]] | [-machine [] [out]] )#$^+$ 



\noindent or 


\indent \verb#java PTG grammar [-start symbol] [-end symbol] [-empty symbol] -all [out] # 


\noindent\verb#grammar# is the file that contains the grammar that will be parsed, it is a required argument and needs to be the first one supplied.

\noindent\verb#start# is an optional parameter which sets the start variable of the grammar to the supplied symbol. The default is the first variable listed in the grammar.

\noindent\verb#end# is an optional parameter which sets the end of input variable of the grammar to the supplied symbol. The default is \verb#$#.

\noindent\verb#empty# is an optional parameter which sets the empty string of the grammar to the supplied symbol. Default is \verb#<e>#.

\noindent\verb#symbol# a string that should avoid the symbol \verb|#| along with all whitespace.

\noindent\verb#table# should be replaced with one of

\indent\verb#first#

\indent\verb#follow#

\indent\verb#LL1#

\indent\verb#SLR1#

\indent\verb#LALR1#

\indent\verb#LR1#

\indent 

\section{Preparing the Input Grammar File}

The Input Grammar File is a text file that contains the grammar to parse. There are no intended constraints on the filename or it's extension, the filename(that is without the dot and extension) will be used as a default prefix for any output filenames unless a new name is given in the input arguments. In the file each line is one rule, each rule contains a left-hand side, a seperator and a right-hand side in that order. The left-hand side and the seperator are one symbol each whereas the right-hand side is a string consisting of one or more symbols. A symbol is a whitespace terminated string of characters.

So a rule is a string of three or more symbols where the first is the left-hand side and the second is a seperator. PTG will interpret any left-hand side symbols as being a variable in the grammar and the left-hand side of the first rule is the default start variable. Any symbols in a right-hand side that is not a variable is a terminal symbol.

There is one special symbol which is the empty string symbol. In a rule that uses the empty symbol the right-hand side should consist of only the empty string symbol. The default empty string symbol is <e> but a new one can be defined as an input argument. To learn more about rules see \href{http://en.wikipedia.org/wiki/Formal_grammar#Context-free_grammars}{this Wikipedia article}.

Lastly a grammar is terminated by an empty line. This allows a comment to follow after the grammar for whatever reason. An example of a grammar is shown below, this example is used in the Example section below. Here the default start variable is S.

\lstinputlisting{examples/example.gra}


\section{Implementing Generated Files}
\subsection{ \LaTeX{} Tables}
There are two simple ways to use generated \LaTeX{} tables, either by copy pasting or using the input command. PTG generates a tabular environment as opposed to an actual table environment, this is because a table (or other container, for example a figure) has commands that relate to placement of the environment in the document. The input command will allow the use of generated tex files directly. This allows a user to update a grammar file, run PTG for that grammar and then recompile the document. A table or figure environment can be used to contain the input command. Below is an example of how to insert a file named \tt{exampleTable.tex} into a figure:

\begin{figure}[h]
    \begin{minipage}{2in}
        \begin{verbatim}
            \begin{table}
            \centering
            %\input{exampleTable.tex}
            \caption{A caption for the table}
            \label{table:TableLabel}
            \end{table}
        \end{verbatim}
    \end{minipage}
\end{figure}

Both the caption and label commands are optional and the arguments supplied for them are nonsensical, \verb#\centering# is also optional.

\subsection{HTML Tables}
\subsection{Graphviz Statemachines}
Graphviz statemachine files have the extension .gz and should be rendered using Graphviz DOT. An example command to render exampleSM.gz as a png image file named exampleSM.png would be:


\indent\verb#.\dot -Tpng exampleSM.gz -o exampleSM.png#


\noindent Check the DOT documentation for more details. http://www.graphviz.org/pdf/dotguide.pdf

\section{I found a bug, what should I do?}

Sit tight, don't worry, we'll get through this. Send a few line describing what you were doing or intending to do, the command line inputs you used and the input grammar to ebe10@HI.is and hopefully I can fix it or explain it. //
If you can't wait, then feel free to modify the source code in hopes of fixing the bug.//
Also feel free to send me a line with comments or complaints regarding PTG.


\section{An Example}

\begingroup
\obeycr
%\input{example.gra}%
\endgroup%

\begin{table}[h]
    \begin{tabular}{l c r}
        \begin{minipage}{1in}
            %\input{exfirst.tex}
        \end{minipage}
        \qquad
        \begin{minipage}{1in}
            %\input{exfollow.tex}
        \end{minipage}
        \qquad
        \begin{minipage}{1in}
            %\input{exLL1.tex}
        \end{minipage}
    \end{tabular}
    \caption{\tt{FIRST}, \tt{FOLLOW} and \tt{LL(1)} parsing of the example}
    \label{table:ffex}
\end{table}

%\begin{figure}[h]
    %\includegraphics[scale=0.4]{exLR0.png}
    %\centering
    %\\
    %\input{exSLR1.tex}
    %\caption{\tt{LR(0)} and \tt{SLR(1)} of the example.}
    %\label{table:slrex}
%\end{figure}

%\begin{figure}[h]
    %\includegraphics[scale=0.4]{exLR1.png}
    %\centering
    %\\
    %\input{exLALR1.tex}
    %\caption{\tt{LALR(1)} of the example.}
    %\label{table:slrex}
%\end{figure}


\end{document}